<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å·¥å…·æç¤ºå®šä½æµ‹è¯•</title>
    <style>
        body {
            margin: 0;
            padding: 20px;
            font-family: Arial, sans-serif;
            background: #f0f0f0;
        }
        .test-area {
            position: relative;
            width: 100%;
            height: 100vh;
            border: 2px solid #333;
            background: white;
        }
        .corner {
            position: absolute;
            padding: 10px;
            background: #e0e0e0;
            border: 1px solid #999;
            border-radius: 5px;
            font-size: 14px;
        }
        .top-left {
            top: 10px;
            left: 10px;
        }
        .top-right {
            top: 10px;
            right: 10px;
        }
        .bottom-left {
            bottom: 10px;
            left: 10px;
        }
        .bottom-right {
            bottom: 10px;
            right: 10px;
        }
        .center {
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
        }
        .edge-left {
            top: 50%;
            left: 10px;
            transform: translateY(-50%);
        }
        .edge-right {
            top: 50%;
            right: 10px;
            transform: translateY(-50%);
        }
        .edge-top {
            top: 10px;
            left: 50%;
            transform: translateX(-50%);
        }
        .edge-bottom {
            bottom: 10px;
            left: 50%;
            transform: translateX(-50%);
        }
        .instructions {
            position: fixed;
            top: 10px;
            left: 50%;
            transform: translateX(-50%);
            background: rgba(0, 0, 0, 0.8);
            color: white;
            padding: 10px 20px;
            border-radius: 5px;
            z-index: 1000;
            font-size: 12px;
            text-align: center;
        }
        .control-btn {
            margin-top: 5px;
            padding: 5px 10px;
            background: #4CAF50;
            color: white;
            border: none;
            border-radius: 3px;
            cursor: pointer;
            font-size: 11px;
        }
        .control-btn.disabled {
            background: #f44336;
        }
    </style>
</head>
<body>
    <div class="instructions">
        æ‚¬åœæµ‹è¯•ï¼šå°†é¼ æ ‡æ‚¬åœåœ¨ä¸åŒä½ç½®çš„IPåœ°å€ä¸Šï¼Œè§‚å¯Ÿå·¥å…·æç¤ºçš„å®šä½æ•ˆæœ
        <br>
        <button id="toggleExtension" class="control-btn">
            ç¦ç”¨æ‰©å±•å·¥å…·æç¤º
        </button>
    </div>
    
    <div class="test-area">
        <!-- å››ä¸ªè§’è½ -->
        <div class="corner top-left">
            å·¦ä¸Šè§’IP: 192.168.1.1
        </div>
        <div class="corner top-right">
            å³ä¸Šè§’IP: 10.0.0.1
        </div>
        <div class="corner bottom-left">
            å·¦ä¸‹è§’IP: 172.16.0.1
        </div>
        <div class="corner bottom-right">
            å³ä¸‹è§’IP: 8.8.8.8
        </div>
        
        <!-- ä¸­å¿ƒ -->
        <div class="corner center">
            ä¸­å¿ƒIP: 1.1.1.1
        </div>
        
        <!-- è¾¹ç¼˜ -->
        <div class="corner edge-left">
            å·¦è¾¹ç¼˜IP: 203.0.113.1
        </div>
        <div class="corner edge-right">
            å³è¾¹ç¼˜IP: 198.51.100.1
        </div>
        <div class="corner edge-top">
            ä¸Šè¾¹ç¼˜IP: 127.0.0.1
        </div>
        <div class="corner edge-bottom">
            ä¸‹è¾¹ç¼˜IP: 224.0.0.1
        </div>
        
        <!-- éšæœºä½ç½® -->
        <div class="corner" style="top: 25%; left: 25%;">
            éšæœºä½ç½®1: 169.254.1.1
        </div>
        <div class="corner" style="top: 75%; left: 75%;">
            éšæœºä½ç½®2: 240.0.0.1
        </div>
        <div class="corner" style="top: 25%; left: 75%;">
            éšæœºä½ç½®3: 192.0.2.1
        </div>
        <div class="corner" style="top: 75%; left: 25%;">
            éšæœºä½ç½®4: 198.18.0.1
        </div>
    </div>

    <script>
        // å·¥å…·æç¤ºæ§åˆ¶
        let useExtension = true;
        let tooltip = null;
        let currentIP = null;
        
        // åˆ‡æ¢æ‰©å±•ä½¿ç”¨
        document.getElementById('toggleExtension').addEventListener('click', function() {
            useExtension = !useExtension;
            this.textContent = useExtension ? 'ç¦ç”¨æ‰©å±•å·¥å…·æç¤º' : 'å¯ç”¨æ‰©å±•å·¥å…·æç¤º';
            this.classList.toggle('disabled', !useExtension);
            
            if (!useExtension) {
                // ç§»é™¤æ‰©å±•çš„å·¥å…·æç¤º
                const extensionTooltips = document.querySelectorAll('.ip-locator-tooltip');
                extensionTooltips.forEach(tooltip => tooltip.remove());
                console.log('å·²ç§»é™¤æ‰©å±•å·¥å…·æç¤ºï¼Œä½¿ç”¨é¡µé¢å†…å·¥å…·æç¤º');
            } else {
                console.log('å·²å¯ç”¨æ‰©å±•å·¥å…·æç¤º');
            }
        });

        function createTooltip() {
            tooltip = document.createElement('div');
            tooltip.style.cssText = `
                position: fixed;
                background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
                color: white;
                padding: 8px 12px;
                border-radius: 6px;
                font-size: 12px;
                z-index: 10000;
                pointer-events: none;
                opacity: 0;
                transition: opacity 0.2s ease;
                box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
                max-width: 300px;
                white-space: nowrap;
                overflow: hidden;
                text-overflow: ellipsis;
            `;
            document.body.appendChild(tooltip);
        }

        function updateTooltipPosition(mouseX, mouseY) {
            if (!tooltip) return;

            const viewportWidth = window.innerWidth;
            const viewportHeight = window.innerHeight;
            
            // ä¿å®ˆçš„ä¼°ç®—å°ºå¯¸
            const tooltipWidth = 320;
            const tooltipHeight = 100;
            const margin = 20;
            
            let left, top;
            
            // æ°´å¹³å®šä½
            if (mouseX + tooltipWidth + margin < viewportWidth) {
                left = mouseX + margin;
            } else if (mouseX - tooltipWidth - margin > 0) {
                left = mouseX - tooltipWidth - margin;
            } else {
                left = Math.max(margin, (viewportWidth - tooltipWidth) / 2);
            }
            
            // å‚ç›´å®šä½
            if (mouseY - tooltipHeight - margin > 0) {
                top = mouseY - tooltipHeight - margin;
            } else if (mouseY + tooltipHeight + margin < viewportHeight) {
                top = mouseY + margin;
            } else {
                top = Math.max(margin, (viewportHeight - tooltipHeight) / 2);
            }
            
            tooltip.style.left = left + 'px';
            tooltip.style.top = top + 'px';
            
            console.log(`é¡µé¢å†…å·¥å…·æç¤ºä½ç½®: (${left}, ${top}), é¼ æ ‡ä½ç½®: (${mouseX}, ${mouseY})`);
        }

        function showTooltip(ip, x, y) {
            if (!tooltip) createTooltip();
            
            updateTooltipPosition(x, y);
            tooltip.style.opacity = '1';
            tooltip.innerHTML = `
                <div style="display: flex; flex-direction: column; gap: 4px;">
                    <div style="display: flex; align-items: center; gap: 8px;">
                        <span style="font-weight: bold; font-family: monospace;">${ip}</span>
                        <span style="font-size: 14px;">ğŸ‡ºğŸ‡¸</span>
                    </div>
                    <div style="font-size: 11px; opacity: 0.9;">Mountain View, California, United States</div>
                    <div style="font-size: 10px; opacity: 0.8; font-style: italic;">Google LLC</div>
                </div>
            `;
        }

        function hideTooltip() {
            if (tooltip) {
                tooltip.style.opacity = '0';
            }
        }

        // äº‹ä»¶ç›‘å¬ï¼ˆä»…åœ¨ç¦ç”¨æ‰©å±•æ—¶ç”Ÿæ•ˆï¼‰
        document.addEventListener('mouseover', (e) => {
            if (useExtension) return; // å¦‚æœä½¿ç”¨æ‰©å±•ï¼Œä¸å¤„ç†é¡µé¢å†…äº‹ä»¶
            
            const text = e.target.textContent || '';
            const ipRegex = /\b(?:[0-9]{1,3}\.){3}[0-9]{1,3}\b/g;
            const matches = text.match(ipRegex);

            if (matches && matches.length > 0) {
                const ip = matches[0];
                if (ip !== currentIP) {
                    currentIP = ip;
                    showTooltip(ip, e.clientX, e.clientY);
                }
            }
        });

        document.addEventListener('mouseout', (e) => {
            if (useExtension) return;
            hideTooltip();
            currentIP = null;
        });

        document.addEventListener('mousemove', (e) => {
            if (useExtension) return;
            if (tooltip && currentIP) {
                updateTooltipPosition(e.clientX, e.clientY);
            }
        });

        // åˆå§‹åŒ–
        createTooltip();
        console.log('é¡µé¢å†…å·¥å…·æç¤ºå·²åˆå§‹åŒ–ï¼Œé»˜è®¤ä½¿ç”¨æ‰©å±•å·¥å…·æç¤º');
    </script>
</body>
</html> 